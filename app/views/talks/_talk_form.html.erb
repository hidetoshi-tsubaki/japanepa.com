<%= form_with model: @talk, builder: CustomFormBuilder do |f| %>
    <div class="row">
      <div class="col-md-6">
        <div class="field select_communities">
        <%= f.label :community_id %><br>
        <% if @communities %>
          <%= f.select :community_id, @communities.map{|c| [c.community.name,c.community.id]} %>
        <% else %>
          <%= f.hidden_field :community_id ,:value => @community.id %>
        <% end %>
          <%= f.hidden_field :user_id ,:value => current_user.id %>
        </div>
        <div class="field img_uploader">
          <p>Image</p>
          <div class="post_img_area">
            <img id="prev_img" src="#" class='hidden' />
            <% if @talk.img? %>
              <%= image_tag @talk.img.to_s, class:'present_img' %>
              <%= f.check_box :remove_img  ,class:'remove_img' %>
            <% else %>
              <%= f.hidden_field :img_cache %>
              <img class="present_img" src="https://kukuhana.s3-ap-northeast-1.amazonaws.com/no_img.jpg" />
            <% end %>
            <%= f.file_field :img, id: 'post_img' %>
          </div>
        </div>
      </div>
    </div>
    <div class ="col-md-6">
      <div class="field input_content"> 
        <%= f.label :content %><br>
        <%= f.text_area :content %>
      </div>
    </div>
  </div>
    <div class="actions">
      <%= f.submit "Post" %>
    </div>
<% end %>
<%= javascript_include_tag "prev_img.js" %>